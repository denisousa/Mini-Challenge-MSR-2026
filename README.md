# Replication Package: An Empirical Study of Code Clone Genealogies in Humanâ€“AI Collaborative Development

## ğŸ“‹ Overview

This repository contains the replication package for the paper **â€œCode Clone Genealogy in Humanâ€“Agent Collaborative Software Projectsâ€**, which investigates how **code clone genealogy** evolves in projects where developers actively collaborate with **coding agents powered by Large Language Models (LLMs)**.

**Code clones** are two or more identical or similar code snippets. Their presence can harm maintainability because changes often need to be applied consistently across multiple locations, increasing the risk of inconsistent modifications. To understand how clones evolve over time, we rely on **code clone genealogy**, which captures the evolutionary history of duplicated snippets by linking them across successive versions of a software system, forming **clone lineages**.

When comparing two consecutive versions within a lineage, we characterize how clones evolve through two complementary perspectives:

- **Change Patterns**: modifications to the code snippets inside an existing clone.
- **Evolution Patterns**: additions or removals of code snippets that compose a clone across versions.

We analyzed **350 code clone lineages** across **6 humanâ€“agent collaborative projects**. Humans introduced most clones (**85.71%**) compared to agents (**14.29%**). Although clone survival rates were similar (humans **80%**, agents **76%**), maintenance differs: **humans predominantly maintain** lineages created by agents, based on Change and Evolution Patterns. Overall, humans remain essential for the long-term evolution of agent-assisted code.

This replication package is intended to support **reproducibility**, enabling other researchers to **re-run the analyses**, **validate the results**, and **extend the study** to additional projects, datasets, or collaboration settings.

## ğŸ“‹ Requirements

- **Python**: 3.12 or 3.13
- **Poetry**: Dependency manager (install via `pip install poetry`)
- **GitHub Token**: Required to access GitHub API (https://github.com/settings/tokens)
- **Git**: To clone repositories

## ğŸš€ Installation

### 1. Clone the Repository

```bash
git clone https://github.com/denisousa/Mini-Challenge-MSR-2026.git
cd Mini-Challenge-MSR-2026
```

### 2. Configure GitHub Token

Create a `.env` file at the project root with your GitHub token:

```bash
echo "GITHUB_TOKEN=your_token_here" > .env
```

**How to get a GitHub token:**
1. Go to https://github.com/settings/tokens
2. Click "Generate new token" â†’ "Generate new token (classic)"
3. Select scopes: `repo`, `read:user`, `user:email`
4. Copy the token and add it to the `.env` file

### 3. Install Dependencies

```bash
poetry install
```

This will install all dependencies listed in `pyproject.toml`:

## ğŸƒ Execution

Run the complete pipeline that executes all 10 analysis scripts in sequence:

```bash
./complete_execution.sh
```

This script will automatically use **Poetry** to run each script in the proper order and provide timing information for each step.

## ğŸ“Š Generated Data and Artifacts

### ğŸ“‚ Artifacts Directory

The **`artifacts/`** directory contains pre-generated data and results. When you run the `complete_execution.sh` script, it will generate the same output in the `main_results` folder.

#### ğŸ“¦ AiDev Dataset

- **`AiDev_Dataset/`**: Contains the original AiDev dataset used in this study (generated by **0_get_aidev.py**). Source: https://huggingface.co/datasets/hao-li/AIDev


#### ğŸ“‹ Analysis and Mining CSVs

CSV files generated during the data mining process by the scripts in `src/`:
- **1_prepare_agents_prs.py**
- **2_prepare_human_prs.py**
- **3_get_balanced_repositories.py**
- **4_get_commits.py**

- **`all_merged_prs_with_repo_info.csv`**: All merged pull requests with repository information
- **`balanced_repositories.csv`**: Repositories selected for balanced comparison between agent and human PRs
- **`human_agent_prs_with_commits.csv`**: Pull requests with associated commits for both human and agent contributions
- **`human_agent_pull_request.csv`**: Filtered pull requests from both humans and agents
- **`new_agent_pull_request.csv`**: Newly identified agent-generated pull requests
- **`new_human_pull_request.csv`**: Newly identified human-generated pull requests

### ğŸ§¬ Genealogy Results Directory

The **`genealogy_results/`** directory contains the code clone genealogy files generated by **5_get_genealogy.py**:

- **`<language>_<project>.xml`**: Contains the complete **code clone genealogy** of each analyzed project. These XML files track the evolution and relationships of code clones throughout the project's history, showing how clones are born, evolve, and die across different commits.
  - Examples: `py_airbytehq_airbyte.xml`, `cs_dotnet_aspire.xml`, `rb_antiwork_flexile.xml`

- NOTE: **`<language>_<project>_clone_density.csv`**: Contains the **clone density metric** for each version of the project. This metric quantifies the proportion of cloned code in each commit/version, providing insights into code duplication patterns over time.
  - Examples: `py_mlflow_mlflow_clone_density.csv`, `cs_microsoft_testfx_clone_density.csv`


### ğŸ“Š Metrics Results Directory

The **`metrics_results/`** directory contains advanced analyses and metrics generated by scripts 6-10. These scripts analyze the genealogies from `genealogy_results/` and produce:

- **Script 6** - `projects_survival_overview.csv`: Lineage survival analysis (alive vs. dead clones by creator)
- **Script 7** - Pattern analysis CSVs:
  - `human_clones_change_patterns.csv`: Change patterns on human-created clones
  - `human_clones_evolution_patterns.csv`: Evolution patterns on human-created clones
  - `agent_clones_change_patterns.csv`: Change patterns on agent-created clones
  - `agent_clones_evolution_patterns.csv`: Evolution patterns on agent-created clones
- **Script 8** - Deep pattern analysis:
  - `evolution_patterns_summary.csv`: Detailed evolution patterns by lineage creator and modifier
  - `change_patterns_summary.csv`: Detailed change patterns by lineage creator and modifier
- **Script 9** - Volatility analysis:
  - `<project_name>_volatility.png`: Volatility graphs for each project
- **Script 10** - Statistical analysis:
  - `statistical_test_output.txt`: Chi-square test results
  - `statistical_test_results.csv`: Statistical test data
  - `correlation_summary.txt`: Correlation summary report

---

## ğŸ“– License

This project is part of the MSR 2026 Mini-Challenge.
